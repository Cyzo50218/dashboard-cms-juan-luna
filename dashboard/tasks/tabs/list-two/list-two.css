/* =====================================================================
// Modern Spreadsheet View CSS
// Final, consolidated, and corrected styles.
// ===================================================================== */

:root {
    /* Variables */
    --primary-bg: #ffffff;
    --secondary-bg: #f9fafb; /* Used for hover and section rows */
    --border-color: #e5e7eb;
    --header-border-color: #d1d5db; /* A slightly darker border for the header */
    --header-height: 45px;
    --task-row-padding: 10px 12px;
}

/* --- Core App Layout --- */
.list-view-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden; /* Prevents the whole page from scrolling */
}

/* We no longer use the old header element for structure */
#task-list-header {
    display: none;
}

/* This is now the single, main scrolling viewport for the entire grid */
#task-list-body {
    flex-grow: 1;
    overflow: auto; /* Handles both horizontal and vertical scrolling */
}

.grid-wrapper {
    display: grid;
}

/* NEW: This uses subgrid to align wrapped rows to the main grid */
.grid-row-wrapper {
    display: grid;
    grid-column: 1 / -1; /* Makes the row span all columns */
    grid-template-columns: subgrid; /* Aligns cells to the parent grid */
}


/* --- Universal Cell Styling --- */
.header-cell,
.task-cell {
    display: flex;
    align-items: center;
    background-color: var(--primary-bg); /* Give all cells a solid background */
    border-right: 1px solid var(--border-color);
    border-bottom: 1px solid var(--border-color);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    transition: background-color 0.15s ease-in-out;
}

.header-cell {
    height: var(--header-height);
    min-height: var(--header-height);
    padding: 0 12px;
    font-weight: 500;
    color: var(--text-secondary-color);
    justify-content: space-between;
}

.task-cell {
    padding: var(--task-row-padding);
    color: var(--text-color);
}


/* =====================================================================
// SPREADSHEET STICKY LOGIC
// ===================================================================== */

/* 1. Make the entire header row sticky to the top */
.header-cell {
    position: sticky;
    top: 0;
    z-index: 2;
    /* Use a box-shadow for a crisp bottom border that stays on top */
    border-bottom: none;
    box-shadow: inset 0 -1px 0 var(--header-border-color);
}

/* 2. Make all cells in the first column sticky to the left */
.sticky-col-task {
    position: sticky;
    left: 0;
    z-index: 1;
    /* Use a box-shadow for a crisp right border that stays on top */
    border-right: none;
    box-shadow: inset -1px 0 0 var(--border-color);
}

/* 3. Make the top-left "Name" header cell sticky in the corner */
.sticky-col-header {
    position: sticky;
    top: 0;
    left: 0;
    z-index: 999; /* Must have the highest z-index */
    justify-content: flex-start;
    /* Combine box-shadows for both bottom and right borders */
    box-shadow: inset -1px 0 0 var(--border-color),
                inset 0 -1px 0 var(--header-border-color);
}

/* Specifically for headers so it sticks above task cells */
.header-cell.sticky-col-task {
    z-index: 10; /* higher than normal cells */
}

/* --- Section Styling --- */
/* A section row's first cell is also a sticky task cell */
.section-title-cell {
    justify-content: space-between;
    font-weight: 600;
    background-color: var(--secondary-bg); /* Give sections a distinct background */
}
/* All other cells in a section row */
.section-placeholder-cell {
    background-color: var(--secondary-bg);
}
.section-title-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
}
.section-toggle {
    cursor: pointer;
}

/*
===========================
//
//  Option Menu for Sections
// 
============================= 
*/
.options-btn-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}
.options-dropdown-menu {
    position: absolute;
    z-index: 1000;
    background-color: var(--primary-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
    padding: 6px;
    min-width: 200px;
    font-size: 14px;
}
.dropdown-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 10px;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}
.dropdown-item:hover {
    background-color: var(--secondary-bg);
}
.dropdown-icon {
    width: 16px;
    text-align: center;
    color: var(--text-secondary-color);
}

/*
===================================
//
// Drag Handle and drop icons design
//
===================================
*/

.drag-handle {
    cursor: grab;
    opacity: 0.6;
    transition: opacity 0.2s ease;
}
.grid-row-wrapper:hover .drag-handle {
    opacity: 1;
}
.drag-handle:active {
    cursor: grabbing;
}
.grid-row-wrapper {
    transition: transform 0.25s ease-in-out;
}
.sortable-drag {
    transition: none !important;
}
.sortable-ghost {
    background: #eef2ff !important;
    border-radius: 8px;
    opacity: 0.7;
}
.sortable-ghost .task-cell {
    visibility: hidden;
}
.sortable-chosen {
    opacity: 0.2;
}
.sortable-drag {
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.42);
    background: var(--primary-bg);
    opacity: 1 !important;
    z-index: 9999 !important;
    /* Make sure the clone itself is also a sub-grid */
    display: grid !important;
}
.is-following-drag {
    opacity: 0.6;
}